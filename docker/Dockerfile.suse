FROM opensuse/leap:latest

# Install runtime dependencies
RUN zypper -n install \
    python3 \
    python3-requests \
    python3-click \
    python3-tomli \
    systemd \
    && zypper clean

WORKDIR /build

# Copy built RPM package
COPY rpm-packages/command-line-assistant-*.rpm ./

# Install the package
RUN zypper -n install command-line-assistant-*.rpm

# Copy test script
COPY docker/test-package.sh /test-package.sh
RUN chmod +x /test-package.sh

# Run tests
CMD ["/test-package.sh"]

